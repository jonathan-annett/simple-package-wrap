!function($N){function packageTemplate(){var $N;($N=typeof process+typeof module+typeof require=="objectobjectfunction"?[module,"exports"]:[window,"${acme}"])[0][$N[1]]=void 0}$N[0][$N[1]]=($N=!!$N[0].id,{build:function(filename,moduleName){if(!filename){if(!process.mainModule)return console.log("usage: build(filename,moduleName)");throw new Error("incorrect arguments passed to build")}var js_source,path=require("path"),fs=require("fs"),UglifyJS=require("uglify-js"),babel=require("babel-core");moduleName="string"==typeof moduleName?moduleName:path.basename(filename).split(".")[0].split("-").join(""),"function"!=typeof(js_source=require(filename))?(js_source=(js_source=fs.readFileSync(filename,"utf8").trim()).substr(0,js_source.lastIndexOf("}")),process.mainModule||console.log("loaded module as string:",js_source.length,"chars")):process.mainModule||console.log("detected exported function:",js_source.toString().length,"chars");var name,pkg_bare,template,js_src,result1,result2,pkg_filename=filename.replace(/\.js$/,".pkg.js"),min_filename=filename.replace(/\.js$/,".min.js");name=moduleName,pkg_bare=js_source.toString().trimEnd(),(template=(template=packageTemplate.toString().trimEnd()).substring(template.indexOf("{")+1,template.length-1).trim().split("function acme_package(){}")).push(template.pop().split("${acme}").join(name)),js_source=template.join("function(){$N=!!$N[0].id;"+pkg_bare.substring(pkg_bare.indexOf("{")+1)),fs.writeFileSync(pkg_filename,js_source),process.mainModule||(console.log("wrote:",pkg_filename),console.log("packaged source:",js_source.length,"chars. minifying...")),js_src=js_source,result1=UglifyJS.minify(js_src,{parse:{},compress:{},mangle:!1,output:{code:!0}}),result2=babel.transform(js_src,{minified:!0}),js_source=result1.code&&result1.code.length<result2.code.length?result1.code:result2.code,fs.writeFileSync(min_filename,js_source),process.mainModule||(console.log("wrote:",min_filename),console.log("final minifed source:",js_source.length,"chars"))},packageTemplate:packageTemplate})}(typeof process+typeof module+typeof require=="objectobjectfunction"?[module,"exports"]:[window,"simplePackageWrap"]);